"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useOpenState = void 0;

var _react = require("react");

/**
 * @param {Object} args
 * @param {string} args.path
 * @param {string} [args.errorMessage]
 * @param {string} [args.autoExpandLoadingError]
 * @param {string[]} args.expanded
 * @param {Function} [args.onExpand]
 * @param {Function} [args.onCollapse]
 * @returns {Object}
 */
const useOpenState = ({
  path,
  expanded,
  onExpand,
  onCollapse,
  errorMessage,
  autoExpandLoadingError
}) => {
  const autoExpand = autoExpandLoadingError && !!errorMessage;
  const [openedOnceDueToError, setOpenedOnce] = (0, _react.useState)(!!errorMessage);
  const [open, setOpen] = (0, _react.useState)(autoExpand || expanded.includes(path));
  (0, _react.useEffect)(() => {
    if (autoExpand && !openedOnceDueToError) {
      setOpen(true);
      setOpenedOnce(true);
    }
  }, [autoExpand, openedOnceDueToError]);

  const onToggleOpen = () => {
    const newOpen = !open;
    const payload = {
      path
    };
    setOpen(newOpen);

    if (onExpand && newOpen) {
      onExpand(payload);
    } else if (onCollapse && !newOpen) {
      onCollapse(payload);
    }
  };

  return {
    open,
    onToggleOpen
  };
};

exports.useOpenState = useOpenState;