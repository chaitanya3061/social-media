"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useDataQuery = void 0;

var _react = require("react");

var _useDataEngine = require("./useDataEngine");

var _useQueryExecutor = require("./useQueryExecutor");

var _useStaticInput = require("./useStaticInput");

const empty = {};

const useDataQuery = (query, {
  onComplete,
  onError,
  variables = empty,
  lazy = false
} = {}) => {
  const engine = (0, _useDataEngine.useDataEngine)();
  const [theQuery] = (0, _useStaticInput.useStaticInput)(query, {
    warn: true,
    name: 'query'
  });
  const execute = (0, _react.useCallback)(options => engine.query(theQuery, options), [engine, theQuery]);
  const {
    refetch,
    called,
    loading,
    error,
    data
  } = (0, _useQueryExecutor.useQueryExecutor)({
    execute,
    variables,
    singular: true,
    immediate: !lazy,
    onComplete,
    onError
  });
  return {
    engine,
    refetch,
    called,
    loading,
    error,
    data
  };
};

exports.useDataQuery = useDataQuery;